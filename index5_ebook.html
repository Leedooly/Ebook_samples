<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>E-Book ìŒìƒ‰ ì„ ì •</title>
<style>
  body {
    font-family: "Noto Sans KR", sans-serif;
    background: #f9f9f9;
    margin: 20px;
  }
  h2 {
    text-align: center;
    margin-bottom: 20px;
  }
  .content {
    width: 80%;
    margin: auto;
    text-align: left;
    line-height: 1.6;
    margin-bottom: 30px;
  }

  #toggleScriptBtn {
    display: inline-block;
    padding: 4px 10px;
    font-size: 14px;
    cursor: pointer;
    border-radius: 4px;
    border: 1px solid #3a86ff;
    background-color: white;
    color: #3a86ff;
    text-align: center;
    width: auto;
    margin-top: 10px;
    user-select: none;
  }
  #toggleScriptBtn:hover {
    background-color: #3a86ff;
    color: white;
  }

  #scriptContent {
    width: 80%;
    margin: 10px auto 30px auto;
    background: #fff;
    border: 1px solid #ccc;
    padding: 15px;
    border-radius: 8px;
    line-height: 1.6;
    white-space: pre-wrap;
    font-family: "Noto Sans KR", sans-serif;
    display: none;
  }

.voice-grid {
  width: 100%;          
  max-width: 80%;       
  margin: 0 auto;       
  display: flex;
  flex-direction: column;
  gap: 14px;
  box-sizing: border-box;
  padding: 0 10px;      
}

.voice-card {
  background: #fff;
  border: 1px solid #ccc;
  padding: 8px 12px;
  border-radius: 8px;
  box-shadow: 1px 1px 6px rgba(0,0,0,0.05);
  display: flex;
  align-items: center;
  gap: 12px;
  height: 45px; 
  box-sizing: border-box;
  width: 100%;
  overflow: hidden;
}

.voice-number {
  font-weight: bold;
  font-size: 16px;
  width: 30px;
  flex-shrink: 0;
  color: #333;
  text-align: center;
}

audio.voice {
  outline: none;
  flex: 1 1 45%;      
  min-width: 250px;
  max-width: 600px;
  height: 30px;
}

.checkbox-container {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 15px;
  flex-shrink: 0;
  min-width: 60px;
  justify-content: center;
}

.reason-input {
  flex: 1 1 35%;
  height: 30px;
  font-size: 13px;
  padding: 5px 8px;
  border: 1px solid #bbb;
  border-radius: 4px;
  resize: none;
  box-sizing: border-box;
  line-height: 20px;
  min-width: 150px;
  max-width: 700px;
  overflow: hidden;
}
  .note {
    text-align: center;
    color: #555;
    margin-top: 10px;
    font-size: 14px;
  }
  .submit-area {
    text-align: center;
    margin-top: 30px;
  }
  .submit-area label {
    font-weight: 600;
    margin-right: 10px;
  }
  .submit-area input[type="text"] {
    padding: 6px 10px;
    font-size: 16px;
    border: 1px solid #bbb;
    border-radius: 4px;
    width: 180px;
  }
  .submit-area button {
    padding: 8px 18px;
    font-size: 16px;
    margin-left: 15px;
    cursor: pointer;
    background-color: #3a86ff;
    color: white;
    border: none;
    border-radius: 4px;
  }
  .submit-area button:hover {
    background-color: #265ecf;
  }
  p.upload-info {
    color: blue;
    text-align: center;
    margin-top: 15px;
    font-size: 14px;
  }
  p.upload-info a {
    color: red;
    text-decoration: none;
  }
  p.upload-info a:hover {
    text-decoration: underline;
  }

  audio::-webkit-media-controls-overflow-button {
    display: none !important;
  }
</style>
</head>
<body>

<h2>E-Book ìŒìƒ‰ ì„ ì •</h2>

<div class="content">
  <p>
    ë‹¤ìŒì€ <b>E-Bookì˜ ìŒìƒ‰ê³¼ ì–´ìš¸ë¦´ ë§Œí•œ ëª©ì†Œë¦¬</b> ìƒ˜í”Œì…ë‹ˆë‹¤. <br>
    ì•„ë˜ì˜ 21ê°œì˜ ìƒ˜í”Œì„ ë“¤ì–´ë³´ì‹  í›„, E-Bookê³¼ ê°€ì¥ ì˜ ì–´ìš¸ë¦¬ëŠ” ëª©ì†Œë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.
  <p>
    <b>ğŸ“Œ ì°¸ê³ ì‚¬í•­ </b><br>
    1. ë“£ê¸° í¸ì•ˆí•œ, ìì—°ìŠ¤ëŸ¬ìš´ ì½ê¸° í†¤ì„ ë– ì˜¬ë ¤ ì£¼ì„¸ìš”.<br>
    2. ë‹¤ì–‘í•œ ì¥ë¥´ì˜ ëŠë‚Œì— ì˜ ë§ëŠ” ìŒìƒ‰ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.
  </p>

  <button id="toggleScriptBtn" onclick="toggleScript()">â–¶ ëŒ€ë³¸ë³´ê¸°</button>
</div>

<div id="scriptContent">ê·¸ ìì‹ ì´ ì„±ìˆ™í•œ ê´´ì§œì˜€ë˜ í”¼ìŠ¤í† ë¦¬ìš°ìŠ¤ëŠ” ë‚´ê²Œ ìš©ê¸°ì™€ ìŠ¤ìŠ¤ë¡œì— ëŒ€í•œ ì¡´ê²½ì„ ê°„ì§í•˜ëŠ” ë²•ì„ ê°€ë¥´ì³¤ë‹¤.
í˜„ëŒ€ìë™ì°¨ëŠ” ì—¬ë¦„ì²  ì°¨ëŸ‰ì˜ ì‹¤ë‚´ ì˜¨ë„ë¥¼ 10â„ƒ ì´ìƒ ë‚®ì¶°ì£¼ëŠ” â€˜ë‚˜ë…¸ ì¿¨ë§ í•„ë¦„â€™ì„ ê°œë°œí•´ í™”ì œë‹¤.
ìš°ë½ë¶€ë½í•œ ê·¼ìœ¡ì§ˆì— ë°”ìœ„ì²˜ëŸ¼ í° ì–¼êµ´, ì§§ê³  êµµì€ ëª©, í•˜ëŠ˜ë¡œ ì¹˜ì†Ÿì€ ëˆˆì¹ì„ ë– ì˜¬ë¦¬ë‹ˆ ì°½ì„ê³¼ ë„ˆë¬´ ë‹®ì•˜ê¸° ë•Œë¬¸ì´ì—ˆë‹¤.
</div>

<div class="voice-grid">

  <div class="voice-card">
    <div class="voice-number">1</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_001.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="1" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">2</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_002.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="2" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">3</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_003.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="3" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">4</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_004.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="4" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">5</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_005.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="5" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">6</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_006.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="6" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">7</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_007.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="7" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">8</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_008.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="8" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">9</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_009.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="9" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">10</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_010.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="10" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">11</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_011.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="11" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">12</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_012.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="12" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">13</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_013.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="13" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">14</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_014.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="14" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">15</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_015.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="15" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">16</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_016.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="16" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">17</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_017.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="17" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">18</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_018.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="18" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">19</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_019.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="19" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">20</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_020.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="20" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

  <div class="voice-card">
    <div class="voice-number">21</div>
    <audio class="voice" controls controlsList="nodownload noplaybackrate" src="e-book_F_021.mp3"></audio>
    <div class="checkbox-container">
      <input type="checkbox" name="voice" value="21" onchange="limitSelection(this)"> ì„ íƒ
    </div>
    <textarea class="reason-input" placeholder="ì„ íƒí•œ ì´ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."></textarea>
  </div>

</div>

<p class="note">â€» ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="submit-area">
  <label for="userName">ì°¸ì—¬ì ì´ë¦„: </label>
  <input type="text" id="userName" placeholder="ì´ë¦„ ì…ë ¥" />
  <button onclick="downloadResults()">ì œì¶œ</button>
</div>

<p class="upload-info">
  ì œì¶œ í›„ ë‹¤ìš´ë¡œë“œëœ <b>[Ebook]_[ì´ë¦„]_results.csv</b> íŒŒì¼ì„ ì•„ë˜ì˜ [ì—…ë¡œë“œí•˜ê¸°] ë§í¬ë¡œ ë“¤ì–´ê°€ì„œ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”. (ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ë¡œë„ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤)<br>
  <a href="https://drive.google.com/drive/u/0/folders/1c0Vr-Ax-dnAKpMVzVIKnN1GSdw8lLAcw" target="_blank">[ì—…ë¡œë“œí•˜ê¸°]</a>
</p>

<script>
function toggleScript() {
  const scriptDiv = document.getElementById('scriptContent');
  const btn = document.getElementById('toggleScriptBtn');
  if (scriptDiv.style.display === 'none' || scriptDiv.style.display === '') {
    scriptDiv.style.display = 'block';
    btn.textContent = 'â–¼ ëŒ€ë³¸ì ‘ê¸°';
  } else {
    scriptDiv.style.display = 'none';
    btn.textContent = 'â–¶ ëŒ€ë³¸ë³´ê¸°';
  }
}

function limitSelection(checkbox) {
  const checkedBoxes = document.querySelectorAll('input[name="voice"]:checked');
  if (checkedBoxes.length > 5) {
    alert("ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    checkbox.checked = false;
  }
}

function downloadResults() {
  const name = document.getElementById("userName").value.trim();
  if (!name) {
    alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
    return;
  }

  const allVoiceCards = document.querySelectorAll('.voice-card');
  const checkedBoxes = document.querySelectorAll('input[name="voice"]:checked');

  if (checkedBoxes.length === 0) {
    alert("ìµœì†Œ í•˜ë‚˜ì˜ ìŒì„±ì„ ì„ íƒí•´ì£¼ì„¸ìš”!");
    return;
  }
  if (checkedBoxes.length > 5) {
    alert("ìµœëŒ€ 5ê°œê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    return;
  }

  let csvContent = "ìŒì„±ë²ˆí˜¸,ì„ íƒì—¬ë¶€,ì´ìœ \n";

  allVoiceCards.forEach(card => {
    const voiceNum = card.querySelector('.voice-number').textContent.trim();
    const isChecked = card.querySelector('input[name="voice"]').checked ? "O" : "X";
    const reason = card.querySelector('.reason-input').value.trim().replace(/,/g, "");
    csvContent += `${voiceNum},${isChecked},${reason}\n`;
  });

  const encodedUri = encodeURI("data:text/csv;charset=utf-8," + csvContent);
  const link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", `Ebook_${name}_results.csv`);
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

document.querySelectorAll('.reason-input').forEach(textarea => {
  textarea.addEventListener('input', function(e) {
    this.value = this.value.replace(/[\n\r,]/g, ''); // ì—”í„°, ì¤„ë°”ê¿ˆ, ì‰¼í‘œ ëª¨ë‘ ì‚­ì œ
  });

  textarea.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
      e.preventDefault(); // ì—”í„°ëŠ” ì•„ì˜ˆ ë§‰ê¸°
    }
  });
});

</script>

</script>

</body>
</html>



